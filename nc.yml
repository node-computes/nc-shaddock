################################################
## SHADDOCK: Services Architecture Definition ##
################################################


- name: nc-etcd 
  image: shaddock/nc-etcd:latest
  priority: 10
  ports:
    - 5672
    - 15672
  volumes:
    - mount: /data/log
      host_dir: /var/log/nc/etcd/log
  env:
    AUTH: XXXX-XXXX-XXXX-XXXX
    ETCD_KEY:



- name: nc-server
  image: shaddock/nc-server:latest
  priority: 20
  ports:
    - 3306
  volumes:
    - mount: /var/log/mysql
      host_dir: /var/log/nc/mysql
  depends-on:
    - {name: nc-etcd, port: 6669}
  env:
    AUTH: XXXX-XXXX-XXXX-XXXX


- name: nc-auth
  image: shaddock/nc-auth:latest
  ports:
    - 8775
  volumes:
    - mount: /var/log/nova
      host_dir: /var/log/shaddock/compute
  network_mode: host
  priority: 90
  depends-on:
    - {name: nc-server, status: started}
    - {name: nc-api, port: 6669}
    - {name: nova, port: 8774}
  env:
    AUTH: XXXX-XXXX-XXXX-XXXX


- name: nc-api
  image: shaddock/keystone:latest
  priority: 30
  ports:
    - 35357
    - 5000
  volumes:
    - mount: /var/log/keystone
      host_dir: /var/log/shaddock/keystone
  depends-on:
    - {name: nc-server, status: started}
    - {name: nc-api, port: 6669}
    - {name: mysql, port: 3306}
  env:
    AUTH: XXXX-XXXX-XXXX-XXXX


- name: nc-virt
  image: shaddock/seed:latest
  priority: 35
  depends-on:
    - {name: nc-server, status: started}
    - {name: nc-api, port: 6669}
  env:
    AUTH: XXXX-XXXX-XXXX-XXXX


- name: nc-network
  image: shaddock/nc-network:latest
  priority: 40
  ports:
    - 8774
  volumes:
    - mount: /var/log/nova
      host_dir: /var/log/shaddock/nova
  privileged: True
  depends-on:
    - {name: nc-server, status: started}
    - {name: nc-api, port: 6669}
  env:
    AUTH: XXXX-XXXX-XXXX-XXXX
    ETCD_KEY: "xxxx-xxxx-xxxx-xxxx"


- name: nc-storage
  image: shaddock/nc-storage:latest
  priority: 50
  ports:
    - 9292
    - 9191
  volumes:
    - mount: /var/log/glance
      host_dir: /var/log/shaddock/glance
  depends-on:
    - {name: seed, status: stopped}
    - {name: mysql, port: 3306}
    - {name: keystone, port: 5000, get: '/v2.0'}
    - {name: keystone, port: 35357, get: '/v2.0'}
  env:
    AUTH: XXXX-XXXX-XXXX-XXXX

